CREATE OR REPLACE PROCEDURE "MMAPDM"."P_DM_CUST_AGREEMENT"
(IO_STATUS OUT INTEGER,IO_SQLERR OUT VARCHAR2)
AS

	TABLE_NAME VARCHAR2(125) :='CUST_AGREEMENT';  -- 表名(修改)
BEGIN
/*
--编辑取数SQL
DELETE MMAPDM.MMAPDM_PROC_SQL WHERE TABLE_NAME='DM_CUST_AGREEMENT';
COMMIT;
INSERT INTO MMAPDM.MMAPDM_PROC_SQL(TABLE_NAME,DMSQL,PROC_NAME) VALUES('DM_CUST_AGREEMENT','
      SELECT
        TO_NUMBER(TO_CHAR((SYSDATE),''YYYYMMDD''))
        ,TX_DATE
        ,PERIOD_ID
        ,CUSTOMER_ID
        ,ACCOUNT_ID
        ,B.ITEM_ID
        ,B.ITEM_NM
        ,0
        ,AGMT_AMT
        ,C.ITEM_ID
        ,C.ITEM_NM
        ,AGMT_BRANCH
        ,D.ITEM_ID
        ,D.ITEM_NM
        ,AGMT_SIGN_DT
        ,AGMT_START_DT
        ,AGMT_END_DT
        ,AGMT_REMARK
      FROM MMAPST.ST_CUST_AGREEMENT A
      LEFT JOIN (SELECT * FROM MMAPDM.MID_ITEM WHERE ITEM_TYP=''AGMT_TYPE'') B
      ON A.AGMT_TYPE_CODE=B.SOURCE_ITEM_ID
      LEFT JOIN (SELECT * FROM MMAPDM.MID_ITEM WHERE ITEM_TYP=''AGMT_STATUS'') C
      ON A.AGMT_STATUS_CODE=B.SOURCE_ITEM_ID
      LEFT JOIN (SELECT * FROM MMAPDM.MID_ITEM WHERE ITEM_TYP=''AGMT_CHANEL'') D
      ON A.AGMT_CHANEL=B.SOURCE_ITEM_ID','P_DM_CUST_AGREEMENT')
;
COMMIT;
*/
    P_DM_FULL(TABLE_NAME,50000,IO_STATUS,IO_SQLERR);
END P_DM_CUST_AGREEMENT;
