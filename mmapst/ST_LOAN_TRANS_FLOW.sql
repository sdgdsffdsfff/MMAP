
TRUNCATE TABLE MMAPST.ST_LOAN_TRANS_FLOW;
INSERT INTO MMAPST.ST_LOAN_TRANS_FLOW(
ETL_DATE,
TX_DATE,
PERIOD_ID,
TRANS_DT,
TRANS_TM,
SER_NO,
OPER_ORG,
CUSTOMER_ID,
ACCOUNT_ID,
TRANSCDE_ID,
TREATMENT_CODE,
TRANSST_ID,
TRANSBR_ID,
CHN_ID,
PRODCDE_ID,
BUSSTYP_ID,
TRANSCURR_ID,
TRANS_AMT,
FEECURR_ID,
TRANS_FEE,
OACCTCURR_ID,
REMARK,
PURPDESC,
PUTOUT_DT,
EXPIRE_DT,
BASE_INT,
DEFAULT_INT,
PAYMTHD_ID,
VOUCHTYPE_ID,
DEPOSITCURR_ID,
R_DEPOSITCURR,
EXPOSURE_AMT,
PAYHOLD_ID,
GUARTYPE_ID,
RESEACCT_ORG,
LOANACCT_ORG,
CLIENTACCT_ORG,
DEPOSITACCT_ORG,
FEEACC_ORG,
REVBRANCH_ID,
REVBRANCH_NM,
DEALSTART_TM,
DEALEND_TM,
DEAL_FG,
REGBRANCH_ID,
REVCIF_NM,
LOANTYPE_ID,
PROMISSORY_NO,
MNCONTRACT_NO,
CRAGREE_NO,
CONTRACT_AMT,
GUARN_NO,
BILL_AMT,
SUBJECT_NO,
SUBJECT2_NO,
SOURCEGRP
) 

SELECT 
TO_NUMBER(TO_CHAR(SYSDATE,'YYYYMMDD')) AS ETL_DATE,
A.TX_DT,
TO_NUMBER(TO_CHAR(A.TX_DT,'YYYYMMDD')) AS PERIOD_ID,
TRANS_DT,
TRANS_TM,
TRIM(SER_NO),
TRIM(OPER_ORG),
TRIM(A.CIF_ORG),
TRIM(ACCT_ORG),
TRIM(TRANSCDE_ID),
NULL AS TREATMEN_TCODE,
TRIM(TRANSST_ID),
TRIM(TRANSBR_ID),
TRIM(CHN_ID),
TRIM(LoanType_ID),
TRIM(BUSSTYP_ID),
TRIM(TRANSCURR_ID),
TRANS_AMT,
TRIM(FEECURR_ID),
TRANS_FEE,
TRIM(OACCTCURR_ID),
A.REMARK,
PURPDESC,
PUTOUT_DT,
EXPIRE_DT,
BASE_INT,
DEFAULT_INT,
TRIM(PAYMTHD_ID),
TRIM(VOUCHTYPE_ID),
TRIM(DEPOSITCURR_ID),
R_DEPOSITCURR,
EXPOSURE_AMT,
TRIM(PAYHOLD_ID),
TRIM(GUARTYPE_ID),
TRIM(RESEACCT_ORG),
TRIM(LOANACCT_ORG),
TRIM(CLIENTACCT_ORG),
TRIM(DEPOSITACCT_ORG),
TRIM(FEEACC_ORG),
TRIM(REVBRANCH_ID),
TRIM(REVBRANCH_NM),
DEALSTART_TM,
DEALEND_TM,
TRIM(DEAL_FG),
TRIM(REGBRANCH_ID),
TRIM(REVCIF_NM),
TRIM(LOANTYPE_ID),
TRIM(PROMISSORY_NO),
TRIM(MNCONTRACT_NO),
TRIM(CRAGREE_NO),
CONTRACT_AMT,
TRIM(GUARN_NO),
BILL_AMT,
TRIM(SUBJECT_NO),
TRIM(SUBJECT2_NO),
NULL AS SOURCEGRP
FROM MMAPST.DMMKT_EVLNTRANS a
inner join MMAPST.DMMKT_CSMast b 
on a.CIF_ORG=b.CIF_ORG
where trim(b.CIFTYP_ID)='I';
